# 廃棄申請処理

パッケージ事業部より、電脳工場で伊藤園向け請求書を作成するように希望がありました。
その請求書の内訳明細には廃棄データも記入必要となりますが、現状は電脳工場が廃棄データを管理していませんので、抽出できません。
なので、廃棄処理について、機能を設計して追加になります。
また、伊藤園だけではなくて、全社の共通処理として設計を進めます。

## どのような機能ですか？

在庫品がコストとみられるので、任意捨てるのはだめです。なので、
廃棄の実績記録だけではなく、申請＆確認の処理流も必要となりました。
廃棄処理には大体4つステップがあります。

* 廃棄申請
* 廃棄承認
* 廃棄指示
* 廃棄実績入力

![処理フロー](/images/処理フロー.png)

### 廃棄申請
申請人が廃棄申請を作成して提出します。
申請人が営業担当だけではなく、生産管理の方も申請できます。

また、廃棄申請には売上計上区分、廃棄対象、申請理由、合計金額も記入する必要となります。
そして、承認経路の指定も必要となります。

**<u>売上計上区分</u>**
自社都合の場合、売上計上を行わないです。
お客さまより、廃棄するなら、売上計上を行います。（金額が調整する可能性もあります）

**<u>合計金額</u>**
廃棄品の合計金額を自動計算し、表示します。
この金額より、承認者の権限を判断します。
承認者の権限を越える場合、申請を出せず、アラートを表示します。

例えば、合計金額が100万円以上の場合、直接社長のほうに稟議書を提出する旨のメッセージを表示します。

**<u>承認経路</u>**
承認経路には承認者、決裁者、確認者がいます。
* 承認者が申請人の上長です。
申請内容をチェックし、OKなら承認します。
* 決裁者が最終決定を作る人です。
* 確認者は関連の通知先です。

例えば、パッケージ事業部なら、廃棄申請ですが、直接、決裁者とする鈴木事業部長に提出します。

### 廃棄承認
承認者が処理必要な申請を検索し、詳細情報を確認した上で、承認します。
申請の状態が6つあります。

![申請の状態](/images/申請の状態.png)

**<u>未提出</u>**
申請を作成し、未提出の状態です。
この状態で、また編集や取消もできます。

**<u>承認待ち</u>**
提出済み、上長の承認を待ち状態です。この状態の申請だけ上長に見れます。
承認者が承認と差戻の操作ができます。そして、申請者より、取消もできます。
承認できない場合、否認します。

**<u>承認済み</u>**
承認者より承認しました状態です。
承認者がこの承認済み状態で承認取消もできます。

**<u>差戻</u>**
申請内容が修正必要なら、一旦差戻するの状態です。
この状態で、申請者が上長のご指摘の内容に従って、修正終わったら、もう一度申請提出します。

**<u>否認</u>**
申請内容が問題あり、承認できない場合、否認します。

**<u>完了</u>**
承認済みなら、廃棄作業を行います。
廃棄実績がシステムに登録したら、この申請が完了の状態になります。

### 廃棄指示
廃棄申請が承認済みなら、廃棄依頼との旨のメールで工場の方に連絡します。
生産管理方が申請のとおり、廃棄指示を作成します。
作成次第、担当者に廃棄指示通知メールを発送します。

### 廃棄実績入力
担当者が廃棄作業を完成したら、実績を電脳工場に登録します。

## どの方がこの機能を使いますか？
![システム構成](/images/システム構成.png)

サブ機能が申請管理と廃棄管理があります。
申請管理機能のアクターは**申請者**と**承認者**です。
>決裁者が決定できる承認者です。

廃棄管理機能のアクターは**生産管理者**と**廃棄担当者**です。
>生産管理者が承認済みの廃棄申請を受けて、廃棄指示を出します。
>廃棄担当者がその廃棄指示を受けて、廃棄作業を行います。
>最後に廃棄実績情報をシステムに登録します。
